# ============================================================================
# 生產環境配置範例 - Stock Analysis Platform
# ============================================================================
#
# 使用說明：
# 1. 複製此檔案為 .env.production
# 2. 修改所有標記為 CHANGE_THIS 的值
# 3. 確保所有密碼和密鑰都是強隨機值
# 4. 不要將 .env.production 提交到版本控制
#
# 生成隨機密鑰的方法：
# - Fernet Key: python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# - Secret Key: openssl rand -base64 32
# - Password: openssl rand -base64 16
# ============================================================================

# ============================================================================
# 版本標籤
# ============================================================================
VERSION=1.0.0

# ============================================================================
# 資料庫設定 (PostgreSQL)
# ============================================================================
POSTGRES_DB=stock_analysis
POSTGRES_USER=stock_admin
POSTGRES_PASSWORD=CHANGE_THIS_STRONG_PASSWORD_MIN_16_CHARS  # 請修改！

# SQLAlchemy 連接配置
DATABASE_URL=postgresql://stock_admin:CHANGE_THIS@postgres:5432/stock_analysis
DATABASE_ECHO=false
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=40
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=3600

# ============================================================================
# Redis 設定
# ============================================================================
REDIS_PASSWORD=CHANGE_THIS_REDIS_PASSWORD  # 請修改！
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_SOCKET_TIMEOUT=5
REDIS_DEFAULT_TTL=1800
REDIS_STOCK_LIST_TTL=3600
REDIS_PRICE_DATA_TTL=600

REDIS_URL=redis://:CHANGE_THIS_REDIS_PASSWORD@redis:6379/0

# ============================================================================
# 安全設定 (JWT & CORS)
# ============================================================================
# 使用 openssl rand -base64 32 生成
SECURITY_SECRET_KEY=CHANGE_THIS_SECRET_KEY_32_CHARS_OR_MORE  # 請修改！
SECURITY_JWT_ALGORITHM=HS256
SECURITY_ACCESS_TOKEN_EXPIRE_MINUTES=60

# CORS 設定 - 修改為您的域名
SECURITY_CORS_ORIGINS=["https://yourdomain.com","https://www.yourdomain.com"]
SECURITY_CORS_CREDENTIALS=true

# ============================================================================
# 應用程式設定
# ============================================================================
APP_NAME=股票分析平台
APP_VERSION=1.0.0
APP_DEBUG=false
APP_ENVIRONMENT=production
APP_API_V1_PREFIX=/api/v1
APP_DOCS_URL=  # 生產環境關閉 API 文檔
APP_REDOC_URL=
APP_DEFAULT_STOCK_LIMIT=100
APP_MAX_STOCK_LIMIT=1000
APP_DEFAULT_INDICATOR_PERIOD=14
APP_MAX_INDICATOR_DAYS=365

# ============================================================================
# 外部 API 設定
# ============================================================================
# 價格數據源配置 (yahoo_finance, alpha_vantage, fmp)
EXTERNAL_API_PRICE_DATA_SOURCE=yahoo_finance
EXTERNAL_API_YAHOO_FINANCE_TIMEOUT=30
EXTERNAL_API_YAHOO_FINANCE_RETRIES=3
EXTERNAL_API_RATE_LIMIT_REQUESTS=100
EXTERNAL_API_RATE_LIMIT_PERIOD=60

# Alpha Vantage API (可選)
# EXTERNAL_API_ALPHA_VANTAGE_KEY=your_alpha_vantage_key

# Financial Modeling Prep API (可選)
# EXTERNAL_API_FMP_KEY=your_fmp_key

# ============================================================================
# 日誌設定
# ============================================================================
LOG_LEVEL=INFO
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
LOG_FILE_PATH=/app/logs/app.log
LOG_MAX_FILE_SIZE=10485760  # 10MB
LOG_BACKUP_COUNT=10

# ============================================================================
# Apache Airflow 設定
# ============================================================================
# 使用 python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
AIRFLOW_FERNET_KEY=CHANGE_THIS_AIRFLOW_FERNET_KEY  # 請修改！
AIRFLOW_SECRET_KEY=CHANGE_THIS_AIRFLOW_SECRET_KEY  # 請修改！

# Airflow 管理員帳號
AIRFLOW_ADMIN_USER=admin
AIRFLOW_ADMIN_PASSWORD=CHANGE_THIS_AIRFLOW_ADMIN_PASSWORD  # 請修改！
AIRFLOW_ADMIN_EMAIL=admin@yourdomain.com  # 請修改！

# ============================================================================
# 前端環境變數
# ============================================================================
# 修改為您的實際域名
NEXT_PUBLIC_API_URL=https://api.yourdomain.com
NEXT_PUBLIC_WS_URL=wss://api.yourdomain.com/ws

# ============================================================================
# 備份設定
# ============================================================================
BACKUP_ENABLED=true
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=  # 可選：S3 備份桶名稱
BACKUP_S3_REGION=  # 可選：S3 區域

# ============================================================================
# 監控與告警設定 (可選)
# ============================================================================
# Sentry (錯誤追蹤)
# SENTRY_DSN=https://your-sentry-dsn

# Email 告警設定
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your-email@gmail.com
# SMTP_PASSWORD=your-app-password
# SMTP_FROM=noreply@yourdomain.com
# ALERT_EMAIL=admin@yourdomain.com

# ============================================================================
# 效能調優
# ============================================================================
# Uvicorn Workers (建議為 CPU 核心數)
UVICORN_WORKERS=2
UVICORN_WORKER_CLASS=uvicorn.workers.UvicornWorker
UVICORN_TIMEOUT=120

# ============================================================================
# 安全強化
# ============================================================================
# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_BURST=10

# IP 白名單 (可選，逗號分隔)
# ALLOWED_IPS=1.2.3.4,5.6.7.8

# ============================================================================
# 注意事項
# ============================================================================
#
# 1. 所有標記為 CHANGE_THIS 的值都必須修改
# 2. 密碼長度建議至少 16 字符，包含大小寫字母、數字和特殊字符
# 3. Fernet Key 必須是 32 字節的 base64 編碼字符串
# 4. 生產環境必須使用 HTTPS
# 5. 定期更換密鑰和密碼
# 6. 設置防火牆規則，只開放 80 和 443 端口
# 7. 啟用自動備份並測試恢復流程
#
# ============================================================================
